p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.05, "< 0.05", "> 0.05"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n",
"-------------------------\n",
"INTERPRETATION:\n",
"R-Squared value shows that ", r_squared * 100, "% of clubs having different ranks is related to their squad value\n",
)
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.05, "< 0.05", "> 0.05"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n",
"-------------------------\n",
"INTERPRETATION:\n",
"R-Squared value shows that ", r_squared * 100, "% of clubs having different ranks is related to their squad value\n"
)
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.05, "< 0.05", "> 0.05"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n",
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.05, "< 0.05", "> 0.05"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", round(p_value, 4), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", round(p_value, 3), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", round(p_value, 10), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.001, "< 0.001", "> 0.001"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.0001, "< 0.0001", "> 0.001"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.0001, "< 0.0001", "> 0.001"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.00001, "< 0.0001", "> 0.001"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.00001, "< 0.00001", "> 0.001"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.000001, "< 0.00001", "> 0.001"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.000001, "< 0.000001", "> 0.001"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.0000000001, "< 0.0000000001", "> 0.001"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.001, "< 0.001", "> 0.001"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.001, "< 0.001", "> 0.001"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
# Apply linear regression model
model <- lm(league_rank ~ squad_value, data = data)
# Extract key insights from model
r_squared <- summary(model)$r.squared
p_value <- summary(model)$coefficients[2, 4]
slope <- coef(model)["squad_value"]
cat("Linear Regression Results:\n",
"-------------------------\n",
"R-squared: ", round(r_squared, 3), "\n",
"P-value: ", ifelse(p_value < 0.001, "< 0.001", "> 0.001"), "\n", "Slope (Coefficient): ", round(slope, 4), "\n")
data |> ggplot(aes(x = season, y = league_rank, fill = npxG)) + geom_tile(color = "grey50") + scale_x_continuous(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
library(tidyverse)
library(dslabs)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(RColorBrewer)
library(rvest)
library(readxl)
library(readr)
library(janitor)
library(gt)
library(knitr)
data |> ggplot(aes(x = season, y = league_rank, fill = npxG)) + geom_tile(color = "grey50") + scale_x_continuous(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
data |> group_by(league_rank) |> ggplot(aes(x = season, y = league_rank, fill = npxG)) + geom_tile(color = "grey50") + scale_x_continuous(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
data |> group_by(league_rank) |> ggplot(aes(x = season, y = league_rank, fill = npxG)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
data |> ggplot(aes(x = season, y = league_rank, fill = npxG)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
data |> group_by(league_rank) |> ggplot(aes(x = season, y = league_rank, fill = npxG)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
data |> ggplot(aes(x = season, y = league_rank, fill = npxG)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
data |> ggplot(aes(x = season, y = league_rank, fill = npxG + possession + xAG)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
data |> ggplot(aes(x = season, y = league_rank, fill = npxG)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
data |> ggplot(aes(x = season, y = league_rank, fill = npxG)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
data |> ggplot(aes(x = season, y = league_rank, fill = npxGA)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
attacking_score <- prcomp(~ npxG + xAG + possession + shot_conversion, data = data, scale = TRUE)
data |> ggplot(aes(x = season, y = league_rank, fill = attackingScore)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
attacking_score <- prcomp(~ npxG + xAG + possession + shot_conversion, data = data, scale = TRUE)
data |> ggplot(aes(x = season, y = league_rank, fill = attacking_score)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
data |> mutate(attacking_score = prcomp(~ npxG + xAG + possession + shot_conversion, data = data, scale = TRUE))
pca_result <- prcomp(~ npxG + xAG + possession + shot_conversion,
data = data, scale = TRUE)
data$attacking_score <- pca_result$x[, 1]
data |> ggplot(aes(x = season, y = league_rank, fill = attacking_score)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
data <- data |> mutate(attacking_score = (npxG + xAG + possession + shot_conversion) / 4)
data |> ggplot(aes(x = season, y = league_rank, fill = attacking_score)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
data <- data |> mutate(attacking_score = (npxG + xAG + possession + shot_conversion) / 4)
data |> ggplot(aes(x = season, y = league_rank, fill = attacking_score)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", legend.text = "Attacking Score" ,text = element_text(size = 8))
data <- data |> mutate(attacking_score = (npxG + xAG + possession + shot_conversion) / 4)
data |> ggplot(aes(x = season, y = league_rank, fill = attacking_score)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + labs(title = "Non-penalty Expected Goals vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
data <- data |> mutate(attacking_score = (npxG + xAG + possession + shot_conversion) / 4)
data |> ggplot(aes(x = season, y = league_rank, fill = attacking_score)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt", name = "Composite Attacking Score") + labs(title = "Composite Attacking Score vs League Rank", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
data <- data |> mutate(attacking_score = (npxG + xAG + possession + shot_conversion) / 4)
data |> ggplot(aes(x = season, y = league_rank, fill = attacking_score)) + geom_tile(color = "grey50") + scale_x_discrete(expand = c(0, 0)) + scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt", name = "Composite Attacking Score") + labs(title = "Composite Attacking Score vs League Rank", subtitle = "Composite Attacking Score = (npxG + xAG + possession + shot_conversion) / 4", x = "Season", y = "League Rank") + scale_y_reverse(breaks = seq(1, 20, by = 1)) + theme_minimal() + theme(panel.grid = element_blank(), legend.position="bottom", text = element_text(size = 8))
# Create correlation matrix
#cor_matrix <- full_data %>%
#select(position, possession, xg_for, shots_on_target) %>%
#cor()
# Visualize as heatmap
#corrplot::corrplot(cor_matrix, method = "color")
cor_matrix <- data %>%
select(league_rank, npxG, xAG, possession, shot_conversion) %>%
cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color",
type = "upper",
title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data %>%
select(league_rank, npxG, xAG, possession, shot_conversion) %>%
cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color",
type = "upper",
title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data %>%
select(league_rank, npxG, xAG, possession, shot_conversion) %>%
cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color",
type = "upper",
title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank", mar = c(0, 0, 2, 0))
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank", mar = c(0, 0, 1, 0))
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank", mar = c(1, 0, 1, 0))
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank", mar = c(0, 0, 1, 0))
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank", mar = c(0, 0, 1, 1))
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank", mar = c(0, 1, 1, 1))
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank")
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation: Attacking Metrics & League Rank", mar = c(0, 0, 1, 0))
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attacking Metrics & League Rank", mar = c(0, 0, 1, 0))
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, xAG) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attacking Metrics & League Rank", mar = c(0, 0, 1, 0))
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, xAG) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attacking Metrics & League Rank", mar = c(0, 0, 1, 0))
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attacking Metrics & League Rank", mar = c(0, 0, 1, 0))
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attacking Metrics & League Rank", mar = c(0, 0, 1, 0))
cat("Correlation between league_rank and npxGA:",
cor_matrix["league_rank", "npxGA"], "\n")
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attacking Metrics & League Rank", mar = c(0, 0, 1, 0))
# Create a correlation matrix
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
# Plot correlation matrix
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attacking Metrics & League Rank", mar = c(0, 0, 1, 0))
# Create a correlation matrix
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
# Plot correlation matrix
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attack & Defense Metrics & League Rank", mar = c(0, 0, 1, 0))
# Create a correlation matrix
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
# Plot correlation matrix
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attack & Defense Metrics & League Rank", mar = c(0, 0, 1, 0))
cat("Correlation Analysis Results:\n",
"____________________________\n",
cor_matrix[,]
)
# Create a correlation matrix
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
# Plot correlation matrix
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attack & Defense Metrics & League Rank", mar = c(0, 0, 1, 0))
cat("Correlation Analysis Results:\n",
"____________________________\n",
"Correlation between league rank and npxG:", cor_matrix["league_rank", "npxG"], "\n",
)
# Create a correlation matrix
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
# Plot correlation matrix
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attack & Defense Metrics & League Rank", mar = c(0, 0, 1, 0))
cat("Correlation Analysis Results:\n",
"____________________________\n",
"Correlation between league rank and npxG:", cor_matrix["league_rank", "npxG"], "\n"
)
# Create a correlation matrix
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
# Plot correlation matrix
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attack & Defense Metrics & League Rank", mar = c(0, 0, 1, 0))
cat("Correlation Analysis Results:\n",
"____________________________\n",
"Correlation between league rank and npxG:", cor_matrix["league_rank", "npxG"], "\n"
)
# Create a correlation matrix
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
# Plot correlation matrix
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attack & Defense Metrics & League Rank", mar = c(0, 0, 1, 0))
cat("Correlation Analysis Results:\n",
"_____________________________________________________________________\n",
"Correlation between league rank and npxG:", cor_matrix["league_rank", "npxG"], "\n"
)
# Create a correlation matrix
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
# Plot correlation matrix
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attack & Defense Metrics & League Rank", mar = c(0, 0, 1, 0))
cat("Correlation Analysis Results:\n",
"_____________________________________________________________________\n",
"Correlation between league rank and npxG:", cor_matrix["league_rank", "npxG"], "\n",
"Correlation between league rank and xAG:", cor_matrix["league_rank", "xAG"], "\n",
"Correlation between league rank and possession:", cor_matrix["league_rank", "possession"], "\n",
"Correlation between league rank and shot_conversion:", cor_matrix["league_rank", "shot_conversion"], "\n",
"Correlation between league rank and npxGA:", cor_matrix["league_rank", "npxGA"], "\n")
# Create a correlation matrix
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA, squad_value) |> cor(use = "complete.obs")
# Plot correlation matrix
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attack & Defense Metrics & League Rank", mar = c(0, 0, 1, 0))
cat("Correlation Analysis Results:\n",
"_____________________________________________________________________\n",
"Correlation between league rank and npxG:", cor_matrix["league_rank", "npxG"], "\n",
"Correlation between league rank and xAG:", cor_matrix["league_rank", "xAG"], "\n",
"Correlation between league rank and possession:", cor_matrix["league_rank", "possession"], "\n",
"Correlation between league rank and shot_conversion:", cor_matrix["league_rank", "shot_conversion"], "\n",
"Correlation between league rank and npxGA:", cor_matrix["league_rank", "npxGA"], "\n")
# Create a correlation matrix
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
# Plot correlation matrix
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attack & Defense Metrics & League Rank", mar = c(0, 0, 1, 0))
cat("Correlation Analysis Results:\n",
"_____________________________________________________________________\n",
"Correlation between league rank and npxG:", cor_matrix["league_rank", "npxG"], "\n",
"Correlation between league rank and xAG:", cor_matrix["league_rank", "xAG"], "\n",
"Correlation between league rank and possession:", cor_matrix["league_rank", "possession"], "\n",
"Correlation between league rank and shot_conversion:", cor_matrix["league_rank", "shot_conversion"], "\n",
"Correlation between league rank and npxGA:", cor_matrix["league_rank", "npxGA"], "\n")
cat("Correlation between league rank and squad value:", cor_matrix["league_rank", "squad_value"], "\n")
# Create a correlation matrix
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA, squad_value) |> cor(use = "complete.obs")
# Plot correlation matrix
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attack & Defense Metrics & League Rank", mar = c(0, 0, 1, 0))
cat("Correlation Analysis Results:\n",
"_____________________________________________________________________\n",
"Correlation between league rank and npxG:", cor_matrix["league_rank", "npxG"], "\n",
"Correlation between league rank and xAG:", cor_matrix["league_rank", "xAG"], "\n",
"Correlation between league rank and possession:", cor_matrix["league_rank", "possession"], "\n",
"Correlation between league rank and shot_conversion:", cor_matrix["league_rank", "shot_conversion"], "\n",
"Correlation between league rank and npxGA:", cor_matrix["league_rank", "npxGA"], "\n")
cat("Correlation between league rank and squad value:", cor_matrix["league_rank", "squad_value"], "\n")
# Create a correlation matrix
cor_matrix <- data |> select(league_rank, npxG, xAG, possession, shot_conversion, npxGA) |> cor(use = "complete.obs")
# Plot correlation matrix
corrplot::corrplot(cor_matrix, method = "color", type = "upper", title = "Correlation Matrix: Attack & Defense Metrics & League Rank", mar = c(0, 0, 1, 0))
cat("Correlation Analysis Results:\n",
"_____________________________________________________________________\n",
"Correlation between league rank and npxG:", cor_matrix["league_rank", "npxG"], "\n",
"Correlation between league rank and xAG:", cor_matrix["league_rank", "xAG"], "\n",
"Correlation between league rank and possession:", cor_matrix["league_rank", "possession"], "\n",
"Correlation between league rank and shot_conversion:", cor_matrix["league_rank", "shot_conversion"], "\n",
"Correlation between league rank and npxGA:", cor_matrix["league_rank", "npxGA"], "\n")
model_squad_value <- lm(league_rank ~ squad_value, data = data)
# Model 1: Only squad value
model_squad_value <- lm(league_rank ~ squad_value, data = data)
# Model 2: Only performance stats
model_performance_stats <- lm(league_rank ~ npxG + npxGA, data = data)
# Model 3: Squad Value + Performance
model_combined <- lm(leagure_rank ~ squad_value + npxG + npxGA, data = data)
# Model 1: Only squad value
model_squad_value <- lm(league_rank ~ squad_value, data = data)
# Model 2: Only performance stats
model_performance_stats <- lm(league_rank ~ npxG + npxGA, data = data)
# Model 3: Squad Value + Performance
model_combined <- lm(league_rank ~ squad_value + npxG + npxGA, data = data)
r2_squad_value <- summary(model_squad_value)$r.squared
r2_performance_stats <- summary(model_performance_stats)$r.squared
r2_combined <- summary(model_combined)$r.squared
cat("Model Results\n",
"----------------------------\n",
"Squad value explains: ", r2_squad_value, " of rank variation\n",
"Performance stats explain: ", r2_performance_stats, " of rank variation\n",
"Combined data explain: ", r2_combined, " of rank variation\n")
# Model 1: Only squad value
model_squad_value <- lm(league_rank ~ squad_value, data = data)
# Model 2: Only performance stats
model_performance_stats <- lm(league_rank ~ npxG + npxGA, data = data)
# Model 3: Squad Value + Performance
model_combined <- lm(league_rank ~ squad_value + npxG + npxGA, data = data)
# Extract R squared for each model
r2_squad_value <- summary(model_squad_value)$r.squared
r2_performance_stats <- summary(model_performance_stats)$r.squared
r2_combined <- summary(model_combined)$r.squared
cat("Model Results\n",
"----------------------------\n",
"Squad value alone explains: ", r2_squad_value, " of rank variation\n",
"Performance stats alone explain: ", r2_performance_stats, " of rank variation\n",
"Combined data explain: ", r2_combined, " of rank variation\n",
"Performance stats add: ", r2_combined - r2_squad_value, " beyond squad value alone")
